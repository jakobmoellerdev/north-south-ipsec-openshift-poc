# Generated by Butane; do not edit
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: master
  name: 99-master-ipsec
spec:
  config:
    ignition:
      version: 3.4.0
    storage:
      files:
        - contents:
            compression: gzip
            source: data:;base64,H4sIAAAAAAAC/2zTudKqSADF8Zwq3mFyagpwQ4MJuqGBFhoBabaMzWYV8FNQn37q3mxq7gl/8fn//WsQGdj5S0V+gHWsggD9Vo5grD4CVQVpxMCKIWBYBwT1ZHNcNS85W2OK66VwgIds6IHV0FBEoGcAmSLwJg7PZTH8phF5lkb4LVW5TQJQ6av0IV/0Jhp+kwB/nEDPfpmj/dcIZG+e01tAIXNCCEigRf1abMLWjv2+2HrPZINWxlBDgGSo19m44nyreQgCjwKww1BbwcpzjCELjBgCTz31athMbSMier8dqyaso7MrfpswDfz1ncfSvt/mglIv/emTpDUiT581PPd43WW8pW0SnJufy2vwLVM7vy6CXWhzeXiGT4UYzYtl1RJEZhXf60V+N0N+usp2KX1Ng+eco/wjT3qyC6Y5pp/RbWYdLpebN+w7uHtEZt8pNHCiAbyty2H/MSs/c93caNWDdqsji+doJ6xLcR6cphjZeLq2rzQYXq/C9Jz4Z+kEcoZuDUWhXuYMOdlUVWG9CVgqUTO2oyrnuaTLRYsurZEfp+OPT5JgK+iablxUgwinu68werSANxG5JGpv+EoCJB+j2/C6KcHHPPKchqmzVAfRPwytdQrL3vRlW+4cdBUXv8MOYAQCgP70DY0xBHkOqJ2Sa/XrxEw9jCwXx6q7lfGpqpRZvOGfrmjv9uU2Qzdc9IB6713cL/ne77dafyh9keeK8AF7Ol4HYTi6mToqB2vsDqqnBe1799SX120Jpv1VST5qRh/Se6apaMzJpvS3Y0SQwHOSE3z9VnKkj4XMJR5sLTfFVMDUnS91d7+1d/Hk5orLOrsW8lHRxPui+NmYXBdUePbKc3FwxNvFOHTKh1hmwcqpc1W1VlzLuHp6Q6G8EZNJ/2g2lift0mwlGo1i5r2O9eM6i0+eU5obuD0vRO9aqYzZYGfALOSsmo9MNmIqLO56MmQ3jbd50Lap68CJgSKxcOGspIQNz4X0Cks2fScxgp/9u6G7Ji5T/A/3O13kaP/P+d8AAAD//+pZZCDrAwAA
          mode: 256
          overwrite: true
          path: /etc/pki/certs/ipsec-ns-ca.pem
        - contents:
            compression: gzip
            source: data:;base64,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
          mode: 256
          overwrite: true
          path: /etc/pki/certs/ipsec-ns-south.p12
        - contents:
            compression: gzip
            source: data:;base64,H4sIAAAAAAAC/2TTuxKqugLG8Z4Z3uH0zhmjiGIZQowRAgS5iB0CAnJRkKtPv2etbs/+yt9X////Zyom1Pwfwo5LTxRBF/9VgVGKPi5CMNxmcKIqzOgJMlwxSZk0Hl70953mY2xCjg2Vw4loOGAqJ3DjYTgzUxSim/q7B6xPiP9L0OYVujA9TWBhPzwzjc7MpT+mqdEfM7V/G1PhLAraCzI1M30VMlcN5DFunDejVKUvaKpZ2eZlQY4TUCHHJwgtBLkC//wo0xHkGIpCV0YIDVZU9gRKxRcqm31zhg8jGfrb08VHe9gp5y6PnOehZl2dafAV7neZVz5NQPrAEgWDv52ifMQl/nL70EXgSNsVn9qulO7Sym6B3m3l/PsIkNWhem9uZe/uR64fOU6grthGFPgaMO3ptXdreU+o2NpSYbBwcf11s1dmOTRKXfvl66SN5wISb1k7KVC+O7Sz8n2WNEwUcn8YHq2Hw7rO/CDjl61NbWDIw6av0vAif9jjgkflaL7fKRmXumrp9+yM0cFqFDVfm6Jwb6JlMTvQUiMM4kQu2XK1QR+R/BJ7VgigkxbR9n7IWasFSmUlUnE70MpRpv6R3WAiCnU3F6lHn95HH7+yAclH95yJapBDlUFA0LUlV/qQNI5VNHkQ7qgKOUofxw+AEjiKQvUhkT9uwjTH8MTZyXD5CuOFvMb+2Utc87LZA58quLGHuj93FqlAd1cfMLsnB/x5uaKAa+02rK8X3udLWWL9tvaZbu7Da8B/29q+7pqM2H4nkyC1JdD4Zebd9LdqQLIi+oFboiAXdNXWq/ObUbwUc5lv4v3dj7bn+Netx+ELn4iT9ty9HWAcmySJ2T2GxsY7yNMwTudGFORzcX32GX+sjntnD7PrZ38p9b5yzTRpT11fB2dQLGMFopNx6G1pQUpZy/qggHiYo+tTFJarK9UurtzNIZJRfGvG7fF6Ok3fYpwt7xvG6ct4b7aeVTbfY/L6BDEYE2DHEGl4lI+ZKKR0XMyFEGq8YuFvrtjU/pvwPwEAAP//OUOH8d8DAAA=
          mode: 256
          overwrite: true
          path: /etc/pki/certs/ipsec-ns-north.crt
        - contents:
            compression: gzip
            source: data:;base64,H4sIAAAAAAAC/3SNwQrCMAyG73uKXXZcsTsMPeRhyuzWojaQ/Dv49tIiStDlEvi+hG/hUvrEihE8tr1EQde/J+xgUgRB92H3uCJfaViFH+a4CvKXyfn57Pw0O38yTjRo3m7xScPPXwWkvCN9Q5K39L/UjE1Zd5RqsrUKC9IrAAD//9KnoA3+AAAA
          mode: 480
          overwrite: true
          path: /etc/ipsec.d/host-to-host-cert.conf
        - contents:
            compression: gzip
            source: data:;base64,H4sIAAAAAAAC/4yPMW7sMAxEe59ivtyaJnbL3wW5QIoAqWWZgIT1yopIJdcPIgHpNkjJGcwD3/yPt5R58xpBMgWp1iwdoCdQAosFLrfE37lyKiqBslLwa5E7KMONzESNgncgg3t+XRYH2qHvx3/+8JWPtI0xZ9VphsWk8KrtLgqLgtBqlWzI5y5ICj2bxaVXp0WpP0U+q8VpHulnUoG1muHr2fI+Wu7jv6r0yRqqdZt+DYuX3yXK7XId+Mfs/shaLlc8BoHe4NxXAAAA//9UM8M/hwEAAA==
          mode: 480
          overwrite: true
          path: /usr/local/bin/ipsec-addcert.sh
        - contents:
            compression: ""
            source: data:,%23!%2Fbin%2Fbash%20-e%0Aipsec%20auto%20--add%20host-to-host-cert%0Aipsec%20auto%20--up%20host-to-host-cert
          mode: 480
          overwrite: true
          path: /usr/local/bin/ipsec-configure.sh
    systemd:
      units:
        - contents: |
            [Unit]
            Description=Import external certs into ipsec NSS
            Before=ipsec.service
            [Service]
            Type=oneshot
            ExecStart=/usr/local/bin/ipsec-addcert.sh
            RemainAfterExit=false
            StandardOutput=journal
            [Install]
            WantedBy=multi-user.target
          enabled: true
          name: ipsec-import.service
        - contents: |
            [Service]
            Type=oneshot
            ExecStart=systemctl enable --now ipsec.service
            [Install]
            WantedBy=multi-user.target
          enabled: true
          name: ipsec-enabler.service
        - contents: |
            [Unit]
            Description=Configure IPSec for host-to-host cert authentication
            After=ipsec-enabler.service
            [Service]
            Type=oneshot
            ExecStart=/usr/local/bin/ipsec-configure.sh
            RemainAfterExit=false
            StandardOutput=journal
            [Install]
            WantedBy=multi-user.target
          enabled: true
          name: ipsec-configure.service
  extensions:
    - ipsec
